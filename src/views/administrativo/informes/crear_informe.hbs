<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registro de Mantenimiento</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap" rel="stylesheet">
  <style>
    :root {
      --primary-color: #0769B3;
      --accent-color: #6da8d6;
      --text-color: #333;
      --bg-color: #f0f0f0;
      --border-color: #ccc;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Roboto', sans-serif;
    }

    body {
      background-color: var(--bg-color);
      color: var(--text-color);
      padding: 10px;
      overflow-x: hidden;
    }

    .container {
      width: 100%;
      max-width: 98vw;
      margin: 0 auto;
      background: #fff;
      padding: 20px;
      border-radius: 15px;
      box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
    }

    .header-info {
      text-align: center;
      margin-bottom: 10px;
    }

    .info-section {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
      margin-bottom: 10px;
    }

    .info-row input, .info-row select {
      width: 100%;
      padding: 8px;
      border: 1px solid var(--border-color);
      border-radius: 5px;
      font-size: 14px;
    }

    .table-container {
      overflow-x: auto;
    }

    .combined-table {
      width: 100%;
      border-collapse: collapse;
      font-size: 12px;
      table-layout: fixed;
    }

    .combined-table th, .combined-table td {
      border: 1px solid var(--border-color);
      padding: 5px;
      text-align: center;
      word-wrap: break-word;
    }

    .header {
      background-color: var(--accent-color);
      color: white;
      font-weight: bold;
    }

    h2, h3 {
      font-size: 16px;
      text-align: center;
      margin: 10px 0;
    }

    .btn {
      background-color: #4CAF50;
      color: white;
      padding: 10px 20px;
      font-size: 14px;
      font-weight: bold;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      transition: background-color 0.3s ease;
      display: inline-block;
      margin-top: 20px;
    }

    .btn:hover {
      background-color: #45a049;
    }

    .signature-section {
      display: flex;
      justify-content: space-between;
      gap: 10px;
      margin-top: 20px;
    }

    .signature-section canvas {
      border: 1px solid var(--border-color);
      width: 100%;
      height: 100px;
    }

    @media (max-width: 768px) {
      .info-section {
        grid-template-columns: 1fr;
      }

      .combined-table th, .combined-table td {
        padding: 3px;
      }

      h2, h3 {
        font-size: 14px;
      }

      .btn {
        font-size: 12px;
        padding: 8px 16px;
      }
    }

/* Estilo de los inputs y selects en tamaño pequeño para las tablas y otros campos */
.input-field, .status-input, textarea {
    width: 100%;
    padding: 3px;
    font-size: 8px; /* Tamaño pequeño para evitar superposición */
    border: 1px solid var(--border-color);
    border-radius: 3px;
    box-sizing: border-box;
}

/* Estilo para los inputs y selects en .info-section con tamaño normal */
.info-section .info-row input, .info-section .info-row select {
    width: 100%;
    padding: 8px; /* Tamaño original en .info-section */
    font-size: 12px;
    border: 1px solid var(--border-color);
    border-radius: 5px;
    box-sizing: border-box;
}

/* Ajustes de tabla para que los inputs no se solapen */
.combined-table {
    width: 100%;
    table-layout: fixed;
    font-size: 8px;
}

.combined-table th, .combined-table td {
    border: 1px solid var(--border-color);
    padding: 2px; /* Relleno reducido para evitar solapamientos */
    text-align: center;
    word-wrap: break-word;
}

/* Ajustes adicionales para evitar desbordamientos en dispositivos móviles */
@media (max-width: 768px) {
    .info-section {
        grid-template-columns: 1fr; /* Columnas individuales en pantallas pequeñas */
    }

    .combined-table th, .combined-table td {
        padding: 1px; /* Relleno aún menor para móviles */
        font-size: 7px; /* Reducir el tamaño de fuente en móviles */
    }
}
/* Estilo para la sección de firma, con los campos uno al lado del otro */
.signature-section {
    display: flex;
    justify-content: space-between;
    align-items: center; /* Alineación vertical en el centro */
    gap: 10px;
    margin-top: 20px;
}

.signature-section > div {
    text-align: center;
    width: 45%; /* Espacio suficiente para que ambos campos se alineen horizontalmente */
}

.signature-section canvas {
    border: 1px solid var(--border-color);
    width: 100%;
    height: 100px;
}
   /* Estilos necesarios para la firma */
        .signature-section {
            display: flex;
            justify-content: space-between;
            gap: 10px;
            margin-top: 20px;
        }

        .signature-section canvas {
            border: 1px solid #000;
            cursor: crosshair; /* Cambia el cursor al pasar por el área de firma */
            width: 100%;
            height: 100px;
        }





.botonn {
    display: inline-block;
    padding: 12px 20px;
    font-size: 16px;
    font-weight: bold;
    color: #ffffff;
    background-color: #4caf50; /* Verde profesional */
    border: none;
    border-radius: 8px;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    cursor: pointer;
    transition: all 0.3s ease;
    text-transform: uppercase;
    letter-spacing: 1px;
}

.botonn:hover {
    background-color: #45a049; /* Verde más oscuro */
    box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2);
    transform: translateY(-2px); /* Pequeña elevación */
}

.botonn:active {
    background-color: #388e3c; /* Verde más intenso */
    transform: translateY(0); /* Sin elevación */
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
}

  </style>

<style>
    
</style>







</head>
<body>
  <div class="container">



<br>

<br>
<br>
<br>
    <div class="report-container">
        <!-- Company information section -->
        <div class="company-info">
            <strong>INGENIERÍA HIDRAULIBOMBAS S.A.S</strong><br>
            NIT: 901.454.224-1
        </div>

        <div class="header-info">
     <div class="logo">
    <img id="logo" src="imagenes/logo_ingenieria.jpeg-removebg-preview.png" alt="Logo" width="200"> <!-- Ajusta la ruta del logo -->
</div>



<form id="maintenanceForm">
    <!-- Tu contenido de formulario aquí -->










<div class="info-section">
    <div class="info-row">
        <strong>Cliente:</strong>
<select name="cliente" id="clienteSelect" onchange="fetchClienteCorreo()" required>
    <option value="" disabled selected>Seleccione un cliente</option>
    {{#each clientes}}
        <option value="{{this.id}}">{{this.nombre}}</option>
    {{/each}}
</select>

    </div>
        <div class="info-row">
        <strong>torre:</strong> 
        <input type="text" name="torre" required>
    </div>
<div class="info-row">
    <strong>Correo:</strong>
    <input type="text" id="correoInput" name="Correo" readonly required>
</div>

    <div class="info-row">
        <strong>Tipo de Mantenimiento:</strong> 
        <select name="tipo_de_mantenimiento" required>
            <option value="">Seleccione un tipo</option>
            <option value="Preventivo">Preventivo</option>
            <option value="Correctivo">Correctivo</option>
            <option value="Emergencia">Emergencia</option>
            <option value="Otro">Otro</option>
        </select>
    </div>
<div class="info-row">
    <strong>Equipo:</strong>
    <select name="equipo" id="equipoSelect" required>
        <option value="" disabled selected>Seleccione un equipo</option>
        <option value="Equipo de presión de agua potable">Equipo de presión de agua potable</option>
        <option value="Sistema eyector">Sistema eyector</option>
        <option value="Equipo de presión y eyector">Equipo de presión y eyector</option>
        <option value="Equipo Hidro Flo">Equipo Hidro Flo</option>
        <option value="Equipo Hi press">Equipo Hi press</option>
        <option value="Lavado y desinfección de tanques de abastecimiento">Lavado y desinfección de tanques de abastecimiento</option>
        <option value="Lavado de cajas de aguas residuales">Lavado de cajas de aguas residuales</option>
        <option value="Tubería de aguas negras o residuales">Tubería de aguas negras o residuales</option>
        <option value="Sistema de Detección de red contra incendios">Sistema de Detección de red contra incendios</option>
        <option value="Sistema de Extinción de red contra incendios">Sistema de Extinción de red contra incendios</option>
    </select>
</div>

<div class="info-row">
    <strong>Técnico:</strong>
    <select name="tecnico" required>
        <option value="" disabled selected>Seleccione un técnico</option>
        {{#each tecnicos}}
            <option value="{{this.id}}">{{this.nombre}}</option>
        {{/each}}
    </select>
</div>


    <div class="info-row">
        <strong>Hora Entrada:</strong> 
<input type="time" name="hora_entrada" required autofocus>
    </div>
    <div class="info-row">
        <strong>Hora Salida:</strong> 
        <input type="time" name="hora_salida" required>
    </div>
 <div class="info-row">
    <strong>Fecha:</strong>
    <input type="date" name="fecha" id="fechaActual" required>
</div>

</div>


        </div>


        <div class="registro-container">
            <h2>Registro de Mantenimiento</h2>
        </div>

        <div class="table-container">
            <table class="combined-table">
                <thead>
                    <tr class="header">
                       <strong><th  colspan="5">TABLERO DE CONTROL</th></strong>
                        <th colspan="2">HIDROSISTEMA</th>
                        <th colspan="5">SISTEMAEYECTOR</th>
                    </tr>
            <tr>
                <th>Parámetro</th>
                <th>B1</th>
                <th>B2</th>
                <th>B3</th>
                <th>B4</th>
                <th>Descripción</th>
                <th>Estado</th>
                <th>Parámetro</th>
                <th>B1</th>
                <th>B2</th>
                <th>B3</th>
                <th>B4</th>
            </tr>
        </thead>
        <tbody>
            <tr>
        <td>Variador</td>
<td><input type="text" class="input-field" name="variador_b1"></td>
<td><input type="text" class="input-field" name="variador_b2"></td>
<td><input type="text" class="input-field" name="variador_b3"></td>
<td><input type="text" class="input-field" name="variador_b4"></td>

              <td>Precarga</td>
<td><input type="text" class="hidrosistema-input" name="precarga"></td>

<td>Guarda motor</td>
<td><input type="text" class="input-field" name="guarda_motor_b11"></td>
<td><input type="text" class="input-field" name="guarda_motor_b22"></td>
<td><input type="text" class="input-field" name="guarda_motor_b33"></td>
<td><input type="text" class="input-field" name="guarda_motor_b44"></td>

            </tr>
<tr>
    <td>Mutelillas</td>
    <td><input type="text" class="input-field" name="mutelillas_b1"></td>
    <td><input type="text" class="input-field" name="mutelillas_b2"></td>
    <td><input type="text" class="input-field" name="mutelillas_b3"></td>
    <td><input type="text" class="input-field" name="mutelillas_b4"></td>
    <td>Flotador Mecánico</td>
    <td><input type="text" class="hidrosistema-input" name="flotador_mecanico"></td>
    <td>Breaker </td>
    <td><input type="text" class="input-field" name="breaker_b1"></td>
    <td><input type="text" class="input-field" name="breaker_b2"></td>
    <td><input type="text" class="input-field" name="breaker_b3"></td>
    <td><input type="text" class="input-field" name="breaker_b4"></td>
</tr>

<tr>
    <td>Piloto</td>
    <td><input type="text" class="input-field" name="piloto_b1"></td>
    <td><input type="text" class="input-field" name="piloto_b2"></td>
    <td><input type="text" class="input-field" name="piloto_b3"></td>
    <td><input type="text" class="input-field" name="piloto_b4"></td>
    <td>Válvulas de Succión</td>
    <td><input type="text" class="hidrosistema-input" name="valvulas_succion"></td>
    <td>Muletillas</td>
      <td><input type="text" class="input-field" name="muletillas_b1"></td>
    <td><input type="text" class="input-field" name="muletillas_b2"></td>
    <td><input type="text" class="input-field" name="muletillas_b3"></td>
    <td><input type="text" class="input-field" name="muletillas_b4"></td>
</tr>

   <tr>
    <td>Contactores</td>
    <td><input type="text" class="input-field" name="contactores_b1"></td>
    <td><input type="text" class="input-field" name="contactores_b2"></td>
    <td><input type="text" class="input-field" name="contactores_b3"></td>
    <td><input type="text" class="input-field" name="contactores_b4"></td>
    <td>Tanque Hidro</td>
    <td><input type="text" class="hidrosistema-input" name="tanque_hidro"></td>
    <td>Contacores</td>
    <td><input type="text" class="input-field" name="contacores_b1"></td>
    <td><input type="text" class="input-field" name="contacores_b2"></td>
    <td><input type="text" class="input-field" name="contacores_b3"></td>
    <td><input type="text" class="input-field" name="contacores_b4"></td>
</tr>

   <tr>
    <td>Presostatos</td>
    <td><input type="text" class="input-field" name="presostatos_b1"></td>
    <td><input type="text" class="input-field" name="presostatos_b2"></td>
    <td><input type="text" class="input-field" name="presostatos_b3"></td>
    <td><input type="text" class="input-field" name="presostatos_b4"></td>
    <td>Cheques</td>
    <td><input type="text" class="hidrosistema-input" name="cheques"></td>
    <td>Flotador Electricos</td>
    <td><input type="text" class="input-field" name="flotador_electricos_b1"></td>
    <td><input type="text" class="input-field" name="flotador_electricos_b2"></td>
    <td><input type="text" class="input-field" name="flotador_electricos_b3"></td>
    <td><input type="text" class="input-field" name="flotador_electricos_b4"></td>
</tr>

<tr>
    <td>Alternador</td>
    <td><input type="text" class="input-field" name="alternador_b1"></td>
    <td><input type="text" class="input-field" name="alternador_b2"></td>
    <td><input type="text" class="input-field" name="alternador_b3"></td>
    <td><input type="text" class="input-field" name="alternador_b4"></td>
    <td>Presion de linea</td>
    <td><input type="text" class="hidrosistema-input" name="presion_linea"></td>
    <td>Conexiones</td>
    <td><input type="text" class="input-field" name="conexiones_b11"></td>
    <td><input type="text" class="input-field" name="conexiones_b22"></td>
    <td><input type="text" class="input-field" name="conexiones_b33"></td>
    <td><input type="text" class="input-field" name="conexiones_b44"></td>
</tr>

<tr>
    <td>Guarda motor</td>
    <td><input type="text" class="input-field" name="guarda_motor_b1"></td>
    <td><input type="text" class="input-field" name="guarda_motor_b2"></td>
    <td><input type="text" class="input-field" name="guarda_motor_b3"></td>
    <td><input type="text" class="input-field" name="guarda_motor_b4"></td>
    <td>Registros</td>
    <td><input type="text" class="hidrosistema-input" name="registros"></td>
    <td>Amperaje</td>
 <td><input type="text" class="input-field" name="amperaje_b11"></td>
    <td><input type="text" class="input-field" name="amperaje_b22"></td>
    <td><input type="text" class="input-field" name="amperaje_b33"></td>
    <td><input type="text" class="input-field" name="amperaje_b44"></td>
</tr>

<tr>
    <td>Temporizador</td>
    <td><input type="text" class="input-field" name="temporizador_b1"></td>
    <td><input type="text" class="input-field" name="temporizador_b2"></td>
    <td><input type="text" class="input-field" name="temporizador_b3"></td>
    <td><input type="text" class="input-field" name="temporizador_b4"></td>
    <td>Membrana</td>
    <td><input type="text" class="hidrosistema-input" name="membrana"></td>
    <td>Voltaje</td>
   <td><input type="text" class="input-field" name="voltaje_b11"></td>
    <td><input type="text" class="input-field" name="voltaje_b22"></td>
    <td><input type="text" class="input-field" name="voltaje_b33"></td>
    <td><input type="text" class="input-field" name="voltaje_b44"></td>
</tr>

 <tr>
    <td>Rele Termico</td>
    <td><input type="text" class="input-field" name="rele_termico_b1"></td>
    <td><input type="text" class="input-field" name="rele_termico_b2"></td>
    <td><input type="text" class="input-field" name="rele_termico_b3"></td>
    <td><input type="text" class="input-field" name="rele_termico_b4"></td>
    <td>Manometro</td>
    <td><input type="text" class="hidrosistema-input" name="manometro"></td>
    <td>Sierena</td>
    <td><input type="text" class="input-field" name="sierena_b1"></td>
    <td><input type="text" class="input-field" name="sierena_b2"></td>
    <td><input type="text" class="input-field" name="sierena_b3"></td>
    <td><input type="text" class="input-field" name="sierena_b4"></td>
</tr>

       <tr>
    <td>Flotador Electrico</td>
    <td><input type="text" class="input-field" name="flotador_electrico_b1"></td>
    <td><input type="text" class="input-field" name="flotador_electrico_b2"></td>
    <td><input type="text" class="input-field" name="flotador_electrico_b3"></td>
    <td><input type="text" class="input-field" name="flotador_electrico_b4"></td>
    <td>Cargador de Aire</td>
    <td><input type="text" class="hidrosistema-input" name="cargador_aire"></td>
    <td>Rele termico</td>
    <td><input type="text" class="input-field" name="rele_terminco_b1"></td>
    <td><input type="text" class="input-field" name="rele_terminco_b2"></td>
    <td><input type="text" class="input-field" name="rele_terminco_b3"></td>
    <td><input type="text" class="input-field" name="rele_terminco_b4"></td>
</tr>

     <tr>
    <td>Conexiones</td>
    <td><input type="text" class="input-field" name="conexiones_b1"></td>
    <td><input type="text" class="input-field" name="conexiones_b2"></td>
    <td><input type="text" class="input-field" name="conexiones_b3"></td>
    <td><input type="text" class="input-field" name="conexiones_b4"></td>
    <td>Tanque Reserva</td>
    <td><input type="text" class="hidrosistema-input" name="tanque_reserva"></td>
    <td>Residuos sólidos</td>
    <td><input type="text" class="input-field" name="residuos_b1"></td>
    <td><input type="text" class="input-field" name="residuos_b2"></td>
    <td><input type="text" class="input-field" name="residuos_b3"></td>
    <td><input type="text" class="input-field" name="residuos_b4"></td>
</tr>

 <tr>
    <td>Amperaje</td>
    <td><input type="text" class="input-field" name="amperaje_b1"></td>
    <td><input type="text" class="input-field" name="amperaje_b2"></td>
    <td><input type="text" class="input-field" name="amperaje_b3"></td>
    <td><input type="text" class="input-field" name="amperaje_b4"></td>
    <td>Flauta de descarga</td>
    <td><input type="text" class="hidrosistema-input" name="flauta_descarga"></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
</tr>

  <tr>
    <td>Voltaje</td>
    <td><input type="text" class="input-field" name="voltaje_b1"></td>
    <td><input type="text" class="input-field" name="voltaje_b2"></td>
    <td><input type="text" class="input-field" name="voltaje_b3"></td>
    <td><input type="text" class="input-field" name="voltaje_b4"></td>
    <td></td>
    <td></td>
</tr>

        </tbody>
    </table>
<div class="table-container">
    <table class="combined-table">
        <thead>
            <tr class="header">
                <th colspan="5">MOTOR</th>
                <th colspan="5">BOMBAS</th>
            </tr>
            <tr>
                <th>Parámetro</th>
                <th>M1</th>
                <th>M2</th>
                <th>M3</th>
                <th>M4</th>
                <th>Parámetro</th>
                <th>B1</th>
                <th>B2</th>
                <th>B3</th>
                <th>B4</th>
            </tr>
        </thead>
        <tbody>
            <tr>

    <td>Rodamientos</td>
    <td><input type="text" class="input-field" name="rodamientos_m1"></td>
    <td><input type="text" class="input-field" name="rodamientos_m2"></td>
    <td><input type="text" class="input-field" name="rodamientos_m3"></td>
    <td><input type="text" class="input-field" name="rodamientos_m4"></td>

     <td>Impulsor</td>
    <td><input type="text" class="input-field" name="impulsor_m1"></td>
    <td><input type="text" class="input-field" name="impulsor_m2"></td>
    <td><input type="text" class="input-field" name="impulsor_m3"></td>
    <td><input type="text" class="input-field" name="impulsor_m4"></td>
              
              
              
              
              
<tr>
    <td>Casquillo</td>
    <td><input type="text" name="casquillo_b1" class="input-field"></td>
    <td><input type="text" name="casquillo_b2" class="input-field"></td>
    <td><input type="text" name="casquillo_b3" class="input-field"></td>
    <td><input type="text" name="casquillo_b4" class="input-field"></td>
    <td>Sello Mecánico</td>
    <td><input type="text" name="sello_mecanico_b1" class="input-field"></td>
    <td><input type="text" name="sello_mecanico_b2" class="input-field"></td>
    <td><input type="text" name="sello_mecanico_b3" class="input-field"></td>
    <td><input type="text" name="sello_mecanico_b4" class="input-field"></td>
</tr>

<tr>
    <td>Empaque</td>
    <td><input type="text" name="empaque_b1" class="input-field"></td>
    <td><input type="text" name="empaque_b2" class="input-field"></td>
    <td><input type="text" name="empaque_b3" class="input-field"></td>
    <td><input type="text" name="empaque_b4" class="input-field"></td>
    <td>Empaque</td>
    <td><input type="text" name="empaque_2_b1" class="input-field"></td>
    <td><input type="text" name="empaque_2_b2" class="input-field"></td>
    <td><input type="text" name="empaque_2_b3" class="input-field"></td>
    <td><input type="text" name="empaque_2_b4" class="input-field"></td>
</tr>

<tr>
    <td>Ventilador</td>
    <td><input type="text" name="ventilador_b1" class="input-field"></td>
    <td><input type="text" name="ventilador_b2" class="input-field"></td>
    <td><input type="text" name="ventilador_b3" class="input-field"></td>
    <td><input type="text" name="ventilador_b4" class="input-field"></td>
    <td>Carcasa</td>
    <td><input type="text" name="carcasa_b1" class="input-field"></td>
    <td><input type="text" name="carcasa_b2" class="input-field"></td>
    <td><input type="text" name="carcasa_b3" class="input-field"></td>
    <td><input type="text" name="carcasa_b4" class="input-field"></td>
</tr>

<tr>
    <td>Bornes</td>
    <td><input type="text" name="bornes_b1" class="input-field"></td>
    <td><input type="text" name="bornes_b2" class="input-field"></td>
    <td><input type="text" name="bornes_b3" class="input-field"></td>
    <td><input type="text" name="bornes_b4" class="input-field"></td>
    <td>Casquillo</td>
    <td><input type="text" name="casquillo_b11" class="input-field"></td>
    <td><input type="text" name="casquillo_b22" class="input-field"></td>
    <td><input type="text" name="casquillo_b33" class="input-field"></td>
    <td><input type="text" name="casquillo_b44" class="input-field"></td>
</tr>

<tr>
    <td>Bobinado</td>
    <td><input type="text" name="bobinado_b1" class="input-field"></td>
    <td><input type="text" name="bobinado_b2" class="input-field"></td>
    <td><input type="text" name="bobinado_b3" class="input-field"></td>
    <td><input type="text" name="bobinado_b4" class="input-field"></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
</tr>

        </tbody>
    </table>
</div>
<!-- Campo de texto adicional debajo de la última tabla -->
<div class="additional-field">
    <h3>Partes para Cambio:</h3> <!-- Título similar al de la imagen -->
    <textarea name="partes_para_cambio" rows="4" style="width: 100%; font-size: 12px; border: 1px solid #000;"></textarea> <!-- Campo de texto -->
</div>

<div class="additional-field">
    <h3>Observaciones:</h3> <!-- Título para las observaciones -->
    <textarea name="observaciones" rows="4" style="width: 100%; font-size: 12px; border: 1px solid #000;"></textarea> <!-- Campo de texto -->
</div>
  
<!-- Sección de firma -->
<div class="signature-section">
    <div>
        <canvas id="signatureCanvas1" width="300" height="100"></canvas>
        <br>
        <button type="button" onclick="clearCanvas('signatureCanvas1')">Borrar</button>
        <br>
        <span>TÉCNICO</span>
    </div>
    <div>
        <canvas id="signatureCanvas2" width="300" height="100"></canvas>
        <br>
        <button type="button" onclick="clearCanvas('signatureCanvas2')">Borrar</button>
        <br>
        <span>SUPERVISOR</span>
    </div>
</div>
</div>
  
<!-- Información de contacto debajo de las firmas -->
<div class="contact-info" style="text-align: center; margin-top: 20px; font-size: 12px; color: #0000FF;">
    Carrera 96A No. 65-52 // ingenieriahidraulibombas@gmail.com // Tels.: 6016496010 - 3115989023
</div>

 </div>
<br>
<br>
  </div>
  </div>
















<input id="boton" name="fotos" type="file" multiple accept="image/*">

<br>
    <input id="boton" class="botonn" type="submit" value="ENVIAR INFORME">












  
</form>

 <!-- Botón para enviar el formulario -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.2/html2pdf.bundle.min.js"></script>
<script>
    // Obtener la fecha actual en formato YYYY-MM-DD
    const hoy = new Date().toISOString().split('T')[0];
    // Establecer el valor en el campo de tipo date
    document.getElementById('fechaActual').value = hoy;
</script>




<script>
    document.addEventListener('DOMContentLoaded', function () {
        const horaEntradaInput = document.querySelector('input[name="hora_entrada"]');
        if (horaEntradaInput) {
            // Obtener la hora actual en formato HH:mm
            const ahora = new Date();
            const hora = ahora.getHours().toString().padStart(2, '0');
            const minutos = ahora.getMinutes().toString().padStart(2, '0');
            const horaActual = `${hora}:${minutos}`;

            // Asignar la hora actual como valor por defecto
            horaEntradaInput.value = horaActual;

            // Opcional: enfocar el campo automáticamente
            horaEntradaInput.focus();
        } else {
            console.error("El campo de 'Hora Entrada' no se encontró en el DOM.");
        }
    });
</script>



<!-- Script para habilitar la firma en los canvas -->
<!-- Script para habilitar la firma en los canvas -->
<script>
    
    document.addEventListener('DOMContentLoaded', function() {
    initSignaturePad('signatureCanvas1');
    initSignaturePad('signatureCanvas2');
});

function replaceInputsWithText() {
    const inputs = document.querySelectorAll('input, select, textarea');
    inputs.forEach(input => {
        const value = input.value || input.placeholder;
        const textElement = document.createElement('span');
        textElement.textContent = value;
        textElement.style.border = "1px solid #ccc"; // Opcional: Simula el borde de los inputs
        textElement.style.padding = "2px"; // Opcional: Añade padding para parecerse al input
        input.parentNode.replaceChild(textElement, input);
    });
}

    // Initialize the signature pad for a given canvas
    function initSignaturePad(canvasId) {
        const canvas = document.getElementById(canvasId);
        const ctx = canvas.getContext('2d');
        let drawing = false;

        canvas.addEventListener('mousedown', startDrawing);
        canvas.addEventListener('mouseup', stopDrawing);
        canvas.addEventListener('mousemove', draw);
        canvas.addEventListener('touchstart', startDrawing);
        canvas.addEventListener('touchend', stopDrawing);
        canvas.addEventListener('touchmove', draw);

        function startDrawing(event) {
            drawing = true;
            ctx.beginPath();
            const rect = canvas.getBoundingClientRect();
            const x = (event.clientX || event.touches[0].clientX) - rect.left;
            const y = (event.clientY || event.touches[0].clientY) - rect.top;
            ctx.moveTo(x, y);
        }

        function stopDrawing() {
            drawing = false;
        }

        function draw(event) {
            if (!drawing) return;
            const rect = canvas.getBoundingClientRect();
            const x = (event.clientX || event.touches[0].clientX) - rect.left;
            const y = (event.clientY || event.touches[0].clientY) - rect.top;
            ctx.lineTo(x, y);
            ctx.stroke();
        }
    }

    // Clear the canvas
    function clearCanvas(canvasId) {
        const canvas = document.getElementById(canvasId);
        const ctx = canvas.getContext('2d');
        ctx.clearRect(0, 0, canvas.width, canvas.height);
    }

    // Initialize signature pads for each canvas
    window.onload = function() {
        initSignaturePad('signatureCanvas1');
        initSignaturePad('signatureCanvas2');
    };

    // Get signature data from a canvas as a Base64 string
    function getSignatureDataUrl(canvasId) {
        const canvas = document.getElementById(canvasId);
        return canvas.toDataURL('image/png'); // Returns a Base64-encoded string
    }

    // Capture signatures as Base64-encoded images
    function getSignatureBlobs() {
        const firmaTecnico = getSignatureDataUrl('signatureCanvas1');
        const firmaSupervisor = getSignatureDataUrl('signatureCanvas2');

        return {
            firma_tecnico: firmaTecnico,
            firma_supervisor: firmaSupervisor
        };
    }

    // Handle form submission
    document.getElementById('maintenanceForm').addEventListener('submit', function(event) {
        event.preventDefault(); // Prevent default form submission
        submitForm(); // Call the function to submit data
    });

    // Function to submit form data
    function submitForm() {
        const formData = new FormData(document.getElementById('maintenanceForm'));
        const signatures = getSignatureBlobs();

        // Append the signatures to the form data
        formData.append('firma_tecnico', signatures.firma_tecnico);
        formData.append('firma_supervisor', signatures.firma_supervisor);

        fetch('/insertar-datos', {
            method: 'POST',
            body: formData
        })
        .then(response => response.text())
        .then(data => {
            console.log('Success:', data);
            alert('Datos insertados correctamente');
        })
        .catch((error) => {
            console.error('Error:', error);
            alert('Error al insertar los datos');
        });
    }
    
</script>

<script>


document.getElementById('maintenanceForm').addEventListener('submit', function(event) {
    event.preventDefault(); // Evita el envío tradicional del formulario
    
    var element = document.querySelector('.report-container'); // Selecciona el contenedor principal
    
    // Aplica la clase 'pdf-mode' antes de generar el PDF
    element.classList.add('pdf-mode');
    
    const email = document.querySelector('input[name="Correo"]').value;

    // Configuración del PDF ajustada
    var opt = {
        margin: [0.1, 0.1, 0.1, 0.3],  // Márgenes ajustados para PDF
        filename: 'informe_mantenimiento.pdf',
        image: { type: 'jpeg', quality: 0.98 },
        html2canvas: { scale: 6 },  // Escala aumentada para mejorar la resolución sin sacrificar espacio
        jsPDF: { unit: 'in', format: 'letter', orientation: 'portrait' }
    };

    // Genera el PDF
    html2pdf().from(element).set(opt).outputPdf('blob').then(function (pdfBlob) {
        // Remueve la clase 'pdf-mode' después de generar el PDF
        element.classList.remove('pdf-mode');
        
        // Enviar el informe por correo
        enviarInformePorCorreo(email, pdfBlob);
    });
});


function enviarInformePorCorreo(correo, pdfBlob) {
    const formData = new FormData(document.getElementById('maintenanceForm')); 
    formData.append('pdf', pdfBlob, 'informe_mantenimiento.pdf'); // Attach the generated PDF
    
    fetch('/enviar-correo', {
        method: 'POST',
        body: formData
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            alert('Correo enviado con éxito');
        } else {
            alert('Error al enviar el correo');
        }
    })
    .catch(error => {
        console.error('Error:', error);
        alert('Hubo un error al enviar el correo');
    });
}


</script>


<script>
const tecnico = "{{name}}";  // Obtener el nombre del técnico desde el backend

if (navigator.geolocation) {
  // Configurar el intervalo de 5 minutos (300,000 ms)
  setInterval(() => {
    navigator.geolocation.getCurrentPosition(updatePosition, showError, {
      enableHighAccuracy: true,
      maximumAge: 0,
      timeout: 5000
    });
  }, 300000);  // 5 minutos en milisegundos (usar 120000 para 2 minutos)
}

function updatePosition(position) {
  const latitude = position.coords.latitude;
  const longitude = position.coords.longitude;

  // Enviar la ubicación al servidor automáticamente
  fetch('/guardar_ubicacion', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
    },
    body: JSON.stringify({
      tecnico: tecnico,  // El nombre del técnico
      lat: latitude,
      lng: longitude
    })
  })
  .then(response => response.json())
  .then(data => {
    console.log("Ubicación actualizada:", data);
  })
  .catch((error) => {
    console.error('Error al enviar la ubicación:', error);
  });
}

function showError(error) {
  console.log("Error al obtener la ubicación:", error.message);
}
function startDrawing(event) {
    event.preventDefault(); // Previene comportamientos no deseados
    drawing = true;
    ctx.beginPath();
    const rect = canvas.getBoundingClientRect();
    const x = (event.clientX || event.touches[0].clientX) - rect.left;
    const y = (event.clientY || event.touches[0].clientY) - rect.top;
    ctx.moveTo(x, y);
}

function draw(event) {
    if (!drawing) return;
    event.preventDefault(); // Previene comportamientos no deseados
    const rect = canvas.getBoundingClientRect();
    const x = (event.clientX || event.touches[0].clientX) - rect.left;
    const y = (event.clientY || event.touches[0].clientY) - rect.top;
    ctx.lineTo(x, y);
    ctx.stroke();
}

function stopDrawing(event) {
    event.preventDefault(); // Previene comportamientos no deseados
    drawing = false;
}
async function fetchClienteCorreo() {
    const clienteId = document.getElementById('clienteSelect').value;
    console.log('Cliente seleccionado:', clienteId); // Debug 1

    if (clienteId) {
        try {
            const response = await fetch(`/get_cliente_correo/${clienteId}`);
            const data = await response.json();

            console.log('Respuesta del servidor:', data); // Debug 2

            if (data.success) {
                document.getElementById('correoInput').value = data.correo;
            } else {
                alert(data.message || 'No se pudo obtener el correo del cliente.');
            }
        } catch (error) {
            console.error('Error al obtener el correo del cliente:', error);
            alert('Hubo un error al intentar obtener el correo del cliente.');
        }
    }
}

</script>

